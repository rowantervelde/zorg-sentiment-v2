# Netlify deployment configuration for Nuxt
# https://nuxt.com/deploy/netlify

[build]
  command = "npm run build"
  publish = "dist"
  functions = "netlify/functions"

[build.environment]
  NODE_VERSION = "20"

# Production context: environment variables for production deploys
[context.production.environment]
  NUXT_TREND_WINDOW_HOURS = "48"

# Deploy Preview context: environment variables for pull/merge request previews
[context.deploy-preview.environment]
  NUXT_TREND_WINDOW_HOURS = "8"

# Branch Deploy context: environment variables for branch deploys
[context.branch-deploy.environment]
  NUXT_TREND_WINDOW_HOURS = "8"

# Dev context: environment variables for local development (netlify dev)
[context.dev.environment]
  NUXT_TREND_WINDOW_HOURS = "6"

# Scheduled function for hourly sentiment data collection
[functions."collect-sentiment"]
  schedule = "@hourly"
  # Include config files in function bundle
  included_files = ["server/config/*.json"]
